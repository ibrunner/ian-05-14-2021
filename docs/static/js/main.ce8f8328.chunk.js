(this.webpackJsonpstack=this.webpackJsonpstack||[]).push([[0],{14:function(e,r,t){},16:function(e,r,t){"use strict";t.r(r);var c=t(1),s=t.n(c),n=t(8),i=t.n(n),a=t(3),o=(t(14),t(6));function d(e,r){var t=Object(o.a)(e);return r.length&&r.forEach((function(e){var r=Object(a.a)(e,2),c=r[0],s=r[1],n=t.findIndex((function(e){return e.price===c})),i={price:c,size:s};if(n>=0)s?t.splice(n,1,i):t.splice(n,1);else if(s){var o={price:c,size:s},d=function(e,r){for(var t=0,c=e.length;t<c;){var s=t+c>>>1;e[s].price<r.price?t=s+1:c=s}return t}(t,o);t.splice(d,0,o)}})),t}var l=function(){var e=s.a.useState({asks:[],bids:[]}),r=Object(a.a)(e,2),t=r[0],c=r[1],n=s.a.useState(null),i=Object(a.a)(n,2),o=i[0],l=i[1],u=s.a.useRef(null);return s.a.useEffect((function(){var e={event:"subscribe",feed:"book_ui_1",product_ids:["PI_XBTUSD"]};return u.current=new WebSocket("wss://www.cryptofacilities.com/ws/v1"),u.current.onopen=function(){var r;null===(r=u.current)||void 0===r||r.send(JSON.stringify(e))},u.current.onclose=function(){return console.log("ws closed")},function(){var e;null===(e=u.current)||void 0===e||e.close()}}),[]),s.a.useEffect((function(){u.current&&(u.current.onmessage=function(e){var r=JSON.parse(e.data);c((function(e){var t=e.asks,c=e.bids;return{asks:r.asks?d(t,r.asks):t,bids:r.bids?d(c,r.bids):c}}))},u.current.onerror=function(e){l(e),console.error("WebSocket error observed:",e)})}),[]),{orderSet:t,error:o}},u=t(2),b=[.5,1,2.5,5,10,25,50,100,250,500,1e3,2500];var j=function(e,r){for(var t=[],c=r,s=0,n=0;n<e.length;n++){var i=e[n],a=i.price,o=i.size;if(a<=c)if(t.length)if(t[s].price<c)t.push({price:c,size:o,total:o+t[s].total}),s++;else{var d=t[s],l=d.size+o,b=d.total+o;t.splice(s,1,Object(u.a)(Object(u.a)({},d),{},{size:l,total:b}))}else t.push({price:c,size:o,total:o});else if(c=Math.ceil(a/r)*r,t.length){var j=o+t[s].total;t.push({price:c,size:o,total:j}),s++}else t.push({price:c,size:o,total:o})}return t},p=function(e,r){switch(r.type){case"GROUP_SIZE_DECREASED":var t=b.findIndex((function(r){return r===e.groupSize})),c=t>0,s=c?b[t-1]:e.groupSize;return Object(u.a)(Object(u.a)({},e),{},{asks:c?j(r.orderSet.asks,s):e.asks,bids:c?j(r.orderSet.bids,s):e.bids,groupSize:s});case"GROUP_SIZE_INCREASED":var n=b.findIndex((function(r){return r===e.groupSize})),i=n<b[b.length-1],a=i?b[n+1]:e.groupSize;return Object(u.a)(Object(u.a)({},e),{},{asks:i?j(r.orderSet.asks,a):e.asks,bids:i?j(r.orderSet.bids,a):e.bids,groupSize:a});case"ORDER_SET_UPDATED":return Object(u.a)(Object(u.a)({},e),{},{asks:j(r.orderSet.asks,e.groupSize),bids:j(r.orderSet.bids,e.groupSize)});default:return e}},O=t(0);var h=function(e){var r=e.onIncrease,t=e.onDecrease,c=e.groupSize;return Object(O.jsxs)("div",{className:"group-config",children:[Object(O.jsx)("button",{onClick:t,disabled:c===b[0],children:"-"}),Object(O.jsxs)("div",{className:"group-config-label",children:["Group:"," ",Object(O.jsx)("span",{className:"group-config-size",children:c.toFixed(2).toLocaleString()})]}),Object(O.jsx)("button",{onClick:r,disabled:c===b[b.length-1],children:"+"})]})},f=t(9);var S=function(e){var r=e.orderType,t=e.orders;return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(v,{title:"bids"===r?"Bids":"Asks",orderType:r}),Object(O.jsx)(g,{orders:t,orderType:r})]})};function v(e){var r=e.title,t=e.orderType;return Object(O.jsx)("table",{className:"orders-header ".concat(t),children:Object(O.jsxs)("thead",{children:[Object(O.jsx)("tr",{children:Object(O.jsx)("th",{colSpan:3,children:Object(O.jsx)("div",{className:"orders-header-title",children:r})})}),Object(O.jsxs)("tr",{children:[Object(O.jsx)("th",{className:"price",children:"Price"}),Object(O.jsx)("th",{className:"size",children:"Size"}),Object(O.jsx)("th",{className:"total",children:"Total"})]})]})})}function g(e){var r=e.orderType,t=e.orders,s=t.length?t[t.length-1].total:null;return Object(O.jsx)("div",{className:"orders-table-container ".concat(r),children:Object(O.jsx)("table",{children:Object(O.jsx)("tbody",{children:Object(o.a)(t).reverse().map((function(e){var t=e.price,n=Object(f.a)(e,["price"]);return Object(c.createElement)(x,Object(u.a)(Object(u.a)({},n),{},{price:t,key:t,highValue:s,orderType:r}))}))})})})}function x(e){var r=e.price,t=e.size,c=e.total,s=e.highValue,n=s&&0!==s?c/s*.5:0,i="bids"===e.orderType?"158, 235, 207":"255, 114, 92";return Object(O.jsxs)("tr",{children:[Object(O.jsx)("td",{className:"price",style:{backgroundColor:"rgba(".concat(i,", ").concat(n,")")},children:r.toFixed(2).toLocaleString()}),Object(O.jsx)("td",{children:t.toLocaleString()}),Object(O.jsx)("td",{children:c.toLocaleString()})]})}var k=function(){var e=s.a.useReducer(p,{asks:[],bids:[],groupSize:1}),r=Object(a.a)(e,2),t=r[0],c=r[1],n=l(),i=n.orderSet,o=n.error,d=t.groupSize,u=t.asks,b=t.bids;return s.a.useEffect((function(){c({type:"ORDER_SET_UPDATED",orderSet:i})}),[i]),o?Object(O.jsx)("div",{className:"error-container",children:Object(O.jsx)("div",{className:"error",children:"Error Connecting to API"})}):Object(O.jsx)("div",{className:"app",children:Object(O.jsxs)("div",{className:"layout-container center washed-yellow flex",children:[Object(O.jsx)(h,{groupSize:d,onIncrease:function(){return c({type:"GROUP_SIZE_INCREASED",orderSet:i})},onDecrease:function(){return c({type:"GROUP_SIZE_DECREASED",orderSet:i})}}),Object(O.jsxs)("div",{className:"orders-container",children:[Object(O.jsx)(S,{orderType:"bids",orders:b}),Object(O.jsx)(S,{orderType:"asks",orders:u})]})]})})};i.a.render(Object(O.jsx)(s.a.StrictMode,{children:Object(O.jsx)(k,{})}),document.getElementById("root"))}},[[16,1,2]]]);
//# sourceMappingURL=main.ce8f8328.chunk.js.map